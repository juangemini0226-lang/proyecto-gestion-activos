<!DOCTYPE html>
<html>
<head>
    <title>Lector de QR</title>
    <style>
        body { font-family: sans-serif; display: flex; flex-direction: column; align-items: center; }
        #qr-reader { width: 500px; }
        #qr-reader-results { margin-top: 20px; font-size: 1.2em; }
        @media (max-width: 600px) {
            #qr-reader { width: 100%; }
        }
    </style>
</head>
<body>
    <h1>Escaner de Código QR</h1>

    <div id="qr-reader"></div>

    <div id="qr-reader-results"></div>

    <script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>

    <script>
        // 2. Esta función se ejecuta cuando la librería detecta un QR
        function onScanSuccess(decodedText, decodedResult) {
        // La variable decodedText contiene el código del activo, ej: "MOL-001"
        console.log(`Código escaneado: ${decodedText}`);

        // Construimos la URL a la que queremos ir.
        // OJO: Asegúrate de que la URL base ('/activos/buscar/') sea correcta.
        const url = `/activos/buscar/${decodedText}/`;

        // Le decimos al navegador que vaya a esa nueva URL.
        window.location.href = url;
    }

        // 3. Creamos una nueva instancia del lector de QR
        var html5QrcodeScanner = new Html5QrcodeScanner(
            "qr-reader", // El ID del div donde se mostrará el lector
            { fps: 10, qrbox: 250 } // Configuración: 10 frames por segundo y un cuadro de escaneo de 250px
        );

        // 4. Iniciamos el renderizado del escáner
        html5QrcodeScanner.render(onScanSuccess);
    </script>
</body>
</html>